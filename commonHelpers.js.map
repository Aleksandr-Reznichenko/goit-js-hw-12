{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst API_KEY = '41511602-ac1f0d864a13fd01c911f294b';\nconst searchFormElement = document.querySelector('.search-form');\nconst galleryElement = document.querySelector('.gallery');\nconst textInputElement = document.querySelector('.search-input');\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst loaderElement = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more');\nlet currentPage = 1;\n\nloaderElement.style.display = 'none';\nloadMoreButton.classList.remove('visible');\n\nsearchFormElement.addEventListener('submit', handleFormSubmit);\nloadMoreButton.addEventListener('click', loadMoreImages);\n\nasync function handleFormSubmit(event) {\n  event.preventDefault();\n  const inputValue = textInputElement.value.trim();\n\n  if (!inputValue) {\n    iziToast.warning({\n      title: 'Warning!',\n      message: 'Please enter image name!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  clearGallery();\n  showLoader();\n  hideLoadMoreButton();\n\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: API_KEY,\n        q: inputValue,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: currentPage,\n        per_page: 40,\n      },\n    });\n\n    hideLoader();\n\n    const data = response.data;\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    renderImages(data.hits);\n    lightbox.refresh();\n\n    if (currentPage * 40 >= data.totalHits) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    hideLoader();\n    iziToast.error({\n      message: 'Failed to fetch images. Please try again later.',\n      position: 'topRight',\n    });\n  }\n}\n\nfunction renderImages(images) {\n  const fragment = document.createDocumentFragment();\n\n  images.forEach(image => {\n    const imageCardElement = createImageCard(image);\n    fragment.appendChild(imageCardElement);\n  });\n\n  galleryElement.appendChild(fragment);\n\n  currentPage++;\n}\n\nfunction createImageCard(image) {\n  const imageCardElement = document.createElement('div');\n  imageCardElement.classList.add('card');\n\n  imageCardElement.innerHTML = `\n    <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n        <img class=\"card-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\">\n      </a>\n      <div class=\"card-info\">\n        <p class=\"card-text\"><b>Likes:</b> ${image.likes}</p>\n        <p class=\"card-text\"><b>Views:</b> ${image.views}</p>\n        <p class=\"card-text\"><b>Comments:</b> ${image.comments}</p>\n        <p class=\"card-text\"><b>Downloads:</b> ${image.downloads}</p>\n      </div>\n    `;\n\n  return imageCardElement;\n}\n\nfunction clearGallery() {\n  galleryElement.innerHTML = '';\n  currentPage = 1;\n  hideLoadMoreButton();\n}\n\nasync function loadMoreImages() {\n  const inputValue = textInputElement.value.trim();\n\n  if (!inputValue) {\n    return;\n  }\n\n  showLoader();\n  hideLoadMoreButton();\n\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: API_KEY,\n        q: inputValue,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: currentPage,\n        per_page: 40,\n      },\n    });\n\n    hideLoader();\n\n    const data = response.data;\n\n    if (data.hits.length === 0) {\n      hideLoadMoreButton();\n      return;\n    }\n\n    renderImages(data.hits);\n    lightbox.refresh();\n\n    if (currentPage * 40 >= data.totalHits) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      showLoadMoreButton();\n    }\n\n    const cards = document.querySelectorAll('.card');\n    const newImages = Array.from(cards).slice(-40);\n    if (newImages.length > 0) {\n      const firstNewImage = newImages[0];\n\n      firstNewImage.scrollIntoView({\n        behavior: 'smooth',\n        block: 'start',\n      });\n    }\n  } catch (error) {\n    console.error('Error fetching more images:', error);\n    hideLoader();\n    iziToast.error({\n      message: 'Failed to fetch more images. Please try again later.',\n      position: 'topRight',\n    });\n  }\n}\n\nfunction showLoader() {\n  loaderElement.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loaderElement.style.display = 'none';\n}\n\nfunction showLoadMoreButton() {\n  loadMoreButton.style.display = 'block';\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreButton.style.display = 'none';\n}\n"],"names":["API_KEY","searchFormElement","galleryElement","textInputElement","lightbox","SimpleLightbox","loaderElement","loadMoreButton","currentPage","handleFormSubmit","loadMoreImages","event","inputValue","iziToast","clearGallery","showLoader","hideLoadMoreButton","response","axios","hideLoader","data","renderImages","showLoadMoreButton","error","images","fragment","image","imageCardElement","createImageCard","cards","newImages"],"mappings":"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"}